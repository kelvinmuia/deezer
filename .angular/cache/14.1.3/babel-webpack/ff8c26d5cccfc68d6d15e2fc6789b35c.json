{"ast":null,"code":"import { assign, cloneDeep } from 'lodash-es';\nimport { FuseMockApiUtils } from '@fuse/lib/mock-api';\nimport { brands as brandsData, categories as categoriesData, products as productsData, tags as tagsData, vendors as vendorsData } from 'app/mock-api/apps/ecommerce/inventory/data';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@fuse/lib/mock-api\";\nexport let ECommerceInventoryMockApi = /*#__PURE__*/(() => {\n  class ECommerceInventoryMockApi {\n    /**\n     * Constructor\n     */\n    constructor(_fuseMockApiService) {\n      this._fuseMockApiService = _fuseMockApiService;\n      this._categories = categoriesData;\n      this._brands = brandsData;\n      this._products = productsData;\n      this._tags = tagsData;\n      this._vendors = vendorsData; // Register Mock API handlers\n\n      this.registerHandlers();\n    } // -----------------------------------------------------------------------------------------------------\n    // @ Public methods\n    // -----------------------------------------------------------------------------------------------------\n\n    /**\n     * Register Mock API handlers\n     */\n\n\n    registerHandlers() {\n      // -----------------------------------------------------------------------------------------------------\n      // @ Categories - GET\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/categories').reply(() => [200, cloneDeep(this._categories)]); // -----------------------------------------------------------------------------------------------------\n      // @ Brands - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/brands').reply(() => [200, cloneDeep(this._brands)]); // -----------------------------------------------------------------------------------------------------\n      // @ Products - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/products', 300).reply(({\n        request\n      }) => {\n        // Get available queries\n        const search = request.params.get('search');\n        const sort = request.params.get('sort') || 'name';\n        const order = request.params.get('order') || 'asc';\n        const page = parseInt(request.params.get('page') ?? '1', 10);\n        const size = parseInt(request.params.get('size') ?? '10', 10); // Clone the products\n\n        let products = cloneDeep(this._products); // Sort the products\n\n        if (sort === 'sku' || sort === 'name' || sort === 'active') {\n          products.sort((a, b) => {\n            const fieldA = a[sort].toString().toUpperCase();\n            const fieldB = b[sort].toString().toUpperCase();\n            return order === 'asc' ? fieldA.localeCompare(fieldB) : fieldB.localeCompare(fieldA);\n          });\n        } else {\n          products.sort((a, b) => order === 'asc' ? a[sort] - b[sort] : b[sort] - a[sort]);\n        } // If search exists...\n\n\n        if (search) {\n          // Filter the products\n          products = products.filter(contact => contact.name && contact.name.toLowerCase().includes(search.toLowerCase()));\n        } // Paginate - Start\n\n\n        const productsLength = products.length; // Calculate pagination details\n\n        const begin = page * size;\n        const end = Math.min(size * (page + 1), productsLength);\n        const lastPage = Math.max(Math.ceil(productsLength / size), 1); // Prepare the pagination object\n\n        let pagination = {}; // If the requested page number is bigger than\n        // the last possible page number, return null for\n        // products but also send the last possible page so\n        // the app can navigate to there\n\n        if (page > lastPage) {\n          products = null;\n          pagination = {\n            lastPage\n          };\n        } else {\n          // Paginate the results by size\n          products = products.slice(begin, end); // Prepare the pagination mock-api\n\n          pagination = {\n            length: productsLength,\n            size: size,\n            page: page,\n            lastPage: lastPage,\n            startIndex: begin,\n            endIndex: end - 1\n          };\n        } // Return the response\n\n\n        return [200, {\n          products,\n          pagination\n        }];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Product - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/product').reply(({\n        request\n      }) => {\n        // Get the id from the params\n        const id = request.params.get('id'); // Clone the products\n\n        const products = cloneDeep(this._products); // Find the product\n\n        const product = products.find(item => item.id === id); // Return the response\n\n        return [200, product];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Product - POST\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onPost('api/apps/ecommerce/inventory/product').reply(() => {\n        // Generate a new product\n        const newProduct = {\n          id: FuseMockApiUtils.guid(),\n          category: '',\n          name: 'A New Product',\n          description: '',\n          tags: [],\n          sku: '',\n          barcode: '',\n          brand: '',\n          vendor: '',\n          stock: '',\n          reserved: '',\n          cost: '',\n          basePrice: '',\n          taxPercent: '',\n          price: '',\n          weight: '',\n          thumbnail: '',\n          images: [],\n          active: false\n        }; // Unshift the new product\n\n        this._products.unshift(newProduct); // Return the response\n\n\n        return [200, newProduct];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Product - PATCH\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onPatch('api/apps/ecommerce/inventory/product').reply(({\n        request\n      }) => {\n        // Get the id and product\n        const id = request.body.id;\n        const product = cloneDeep(request.body.product); // Prepare the updated product\n\n        let updatedProduct = null; // Find the product and update it\n\n        this._products.forEach((item, index, products) => {\n          if (item.id === id) {\n            // Update the product\n            products[index] = assign({}, products[index], product); // Store the updated product\n\n            updatedProduct = products[index];\n          }\n        }); // Return the response\n\n\n        return [200, updatedProduct];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Product - DELETE\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onDelete('api/apps/ecommerce/inventory/product').reply(({\n        request\n      }) => {\n        // Get the id\n        const id = request.params.get('id'); // Find the product and delete it\n\n        this._products.forEach((item, index) => {\n          if (item.id === id) {\n            this._products.splice(index, 1);\n          }\n        }); // Return the response\n\n\n        return [200, true];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Tags - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/tags').reply(() => [200, cloneDeep(this._tags)]); // -----------------------------------------------------------------------------------------------------\n      // @ Tags - POST\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onPost('api/apps/ecommerce/inventory/tag').reply(({\n        request\n      }) => {\n        // Get the tag\n        const newTag = cloneDeep(request.body.tag); // Generate a new GUID\n\n        newTag.id = FuseMockApiUtils.guid(); // Unshift the new tag\n\n        this._tags.unshift(newTag); // Return the response\n\n\n        return [200, newTag];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Tags - PATCH\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onPatch('api/apps/ecommerce/inventory/tag').reply(({\n        request\n      }) => {\n        // Get the id and tag\n        const id = request.body.id;\n        const tag = cloneDeep(request.body.tag); // Prepare the updated tag\n\n        let updatedTag = null; // Find the tag and update it\n\n        this._tags.forEach((item, index, tags) => {\n          if (item.id === id) {\n            // Update the tag\n            tags[index] = assign({}, tags[index], tag); // Store the updated tag\n\n            updatedTag = tags[index];\n          }\n        }); // Return the response\n\n\n        return [200, updatedTag];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Tag - DELETE\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onDelete('api/apps/ecommerce/inventory/tag').reply(({\n        request\n      }) => {\n        // Get the id\n        const id = request.params.get('id'); // Find the tag and delete it\n\n        this._tags.forEach((item, index) => {\n          if (item.id === id) {\n            this._tags.splice(index, 1);\n          }\n        }); // Get the products that have the tag\n\n\n        const productsWithTag = this._products.filter(product => product.tags.indexOf(id) > -1); // Iterate through them and delete the tag\n\n\n        productsWithTag.forEach(product => {\n          product.tags.splice(product.tags.indexOf(id), 1);\n        }); // Return the response\n\n        return [200, true];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Vendors - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/ecommerce/inventory/vendors').reply(() => [200, cloneDeep(this._vendors)]);\n    }\n\n  }\n\n  ECommerceInventoryMockApi.ɵfac = function ECommerceInventoryMockApi_Factory(t) {\n    return new (t || ECommerceInventoryMockApi)(i0.ɵɵinject(i1.FuseMockApiService));\n  };\n\n  ECommerceInventoryMockApi.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ECommerceInventoryMockApi,\n    factory: ECommerceInventoryMockApi.ɵfac,\n    providedIn: 'root'\n  });\n  return ECommerceInventoryMockApi;\n})();","map":null,"metadata":{},"sourceType":"module"}