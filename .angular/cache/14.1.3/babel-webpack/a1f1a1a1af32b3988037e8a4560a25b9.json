{"ast":null,"code":"import { assign, cloneDeep, omit } from 'lodash-es';\nimport { chats as chatsData, contacts as contactsData, messages as messagesData, profile as profileData } from 'app/mock-api/apps/chat/data';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@fuse/lib/mock-api\";\nexport let ChatMockApi = /*#__PURE__*/(() => {\n  class ChatMockApi {\n    /**\n     * Constructor\n     */\n    constructor(_fuseMockApiService) {\n      this._fuseMockApiService = _fuseMockApiService;\n      this._chats = chatsData;\n      this._contacts = contactsData;\n      this._messages = messagesData;\n      this._profile = profileData; // Register Mock API handlers\n\n      this.registerHandlers(); // Modify the chats array to attach certain data to it\n\n      this._chats = this._chats.map(chat => ({ ...chat,\n        // Get the actual contact object from the id and attach it to the chat\n        contact: this._contacts.find(contact => contact.id === chat.contactId),\n        // Since we use same set of messages on all chats, we assign them here.\n        messages: this._messages.map(message => ({ ...message,\n          chatId: chat.id,\n          contactId: message.contactId === 'me' ? this._profile.id : chat.contactId,\n          isMine: message.contactId === 'me'\n        }))\n      }));\n    } // -----------------------------------------------------------------------------------------------------\n    // @ Public methods\n    // -----------------------------------------------------------------------------------------------------\n\n    /**\n     * Register Mock API handlers\n     */\n\n\n    registerHandlers() {\n      // -----------------------------------------------------------------------------------------------------\n      // @ Chats - GET\n      // -----------------------------------------------------------------------------------------------------\n      this._fuseMockApiService.onGet('api/apps/chat/chats').reply(() => {\n        // Clone the chats\n        const chats = cloneDeep(this._chats); // Return the response\n\n        return [200, chats];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Chat - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/chat/chat').reply(({\n        request\n      }) => {\n        // Get the chat id\n        const id = request.params.get('id'); // Clone the chats\n\n        const chats = cloneDeep(this._chats); // Find the chat we need\n\n        const chat = chats.find(item => item.id === id); // Return the response\n\n        return [200, chat];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Chat - PATCH\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onPatch('api/apps/chat/chat').reply(({\n        request\n      }) => {\n        // Get the id and chat\n        const id = request.body.id;\n        const chat = cloneDeep(request.body.chat); // Prepare the updated chat\n\n        let updatedChat = null; // Find the chat and update it\n\n        this._chats.forEach((item, index, chats) => {\n          if (item.id === id) {\n            // Update the chat\n            chats[index] = assign({}, chats[index], chat); // Store the updated chat\n\n            updatedChat = chats[index];\n          }\n        }); // Return the response\n\n\n        return [200, updatedChat];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Contacts - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/chat/contacts').reply(() => {\n        // Clone the contacts\n        let contacts = cloneDeep(this._contacts); // Sort the contacts by the name field by default\n\n        contacts.sort((a, b) => a.name.localeCompare(b.name)); // Omit details and attachments from contacts\n\n        contacts = contacts.map(contact => omit(contact, ['details', 'attachments'])); // Return the response\n\n        return [200, contacts];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Contact Details - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/chat/contact').reply(({\n        request\n      }) => {\n        // Get the contact id\n        const id = request.params.get('id'); // Clone the contacts\n\n        const contacts = cloneDeep(this._contacts); // Find the contact\n\n        const contact = contacts.find(item => item.id === id); // Return the response\n\n        return [200, contact];\n      }); // -----------------------------------------------------------------------------------------------------\n      // @ Profile - GET\n      // -----------------------------------------------------------------------------------------------------\n\n\n      this._fuseMockApiService.onGet('api/apps/chat/profile').reply(() => {\n        // Clone the profile\n        const profile = cloneDeep(this._profile); // Return the response\n\n        return [200, profile];\n      });\n    }\n\n  }\n\n  ChatMockApi.ɵfac = function ChatMockApi_Factory(t) {\n    return new (t || ChatMockApi)(i0.ɵɵinject(i1.FuseMockApiService));\n  };\n\n  ChatMockApi.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ChatMockApi,\n    factory: ChatMockApi.ɵfac,\n    providedIn: 'root'\n  });\n  return ChatMockApi;\n})();","map":null,"metadata":{},"sourceType":"module"}