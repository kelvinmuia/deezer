{"ast":null,"code":"import { Renderer2 } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { NavigationEnd } from '@angular/router';\nimport { combineLatest, filter, map, Subject, takeUntil } from 'rxjs';\nimport { FUSE_VERSION } from '@fuse/version';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@fuse/services/config\";\nimport * as i3 from \"@fuse/services/media-watcher\";\nimport * as i4 from \"@fuse/services/platform\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"app/layout/layouts/empty/empty.component\";\nimport * as i7 from \"app/layout/layouts/horizontal/centered/centered.component\";\nimport * as i8 from \"app/layout/layouts/horizontal/enterprise/enterprise.component\";\nimport * as i9 from \"app/layout/layouts/horizontal/material/material.component\";\nimport * as i10 from \"app/layout/layouts/horizontal/modern/modern.component\";\n\nfunction LayoutComponent_empty_layout_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"empty-layout\");\n  }\n}\n\nfunction LayoutComponent_centered_layout_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"centered-layout\");\n  }\n}\n\nfunction LayoutComponent_enterprise_layout_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"enterprise-layout\");\n  }\n}\n\nfunction LayoutComponent_material_layout_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"material-layout\");\n  }\n}\n\nfunction LayoutComponent_modern_layout_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"modern-layout\");\n  }\n}\n\nexport let LayoutComponent = /*#__PURE__*/(() => {\n  class LayoutComponent {\n    /**\n     * Constructor\n     */\n    constructor(_activatedRoute, _document, _renderer2, _router, _fuseConfigService, _fuseMediaWatcherService, _fusePlatformService) {\n      this._activatedRoute = _activatedRoute;\n      this._document = _document;\n      this._renderer2 = _renderer2;\n      this._router = _router;\n      this._fuseConfigService = _fuseConfigService;\n      this._fuseMediaWatcherService = _fuseMediaWatcherService;\n      this._fusePlatformService = _fusePlatformService;\n      this._unsubscribeAll = new Subject();\n    } // -----------------------------------------------------------------------------------------------------\n    // @ Lifecycle hooks\n    // -----------------------------------------------------------------------------------------------------\n\n    /**\n     * On init\n     */\n\n\n    ngOnInit() {\n      // Set the theme and scheme based on the configuration\n      combineLatest([this._fuseConfigService.config$, this._fuseMediaWatcherService.onMediaQueryChange$(['(prefers-color-scheme: dark)', '(prefers-color-scheme: light)'])]).pipe(takeUntil(this._unsubscribeAll), map(([config, mql]) => {\n        const options = {\n          scheme: config.scheme,\n          theme: config.theme\n        }; // If the scheme is set to 'auto'...\n\n        if (config.scheme === 'auto') {\n          // Decide the scheme using the media query\n          options.scheme = mql.breakpoints['(prefers-color-scheme: dark)'] ? 'dark' : 'light';\n        }\n\n        return options;\n      })).subscribe(options => {\n        // Store the options\n        this.scheme = options.scheme;\n        this.theme = options.theme; // Update the scheme and theme\n\n        this._updateScheme();\n\n        this._updateTheme();\n      }); // Subscribe to config changes\n\n      this._fuseConfigService.config$.pipe(takeUntil(this._unsubscribeAll)).subscribe(config => {\n        // Store the config\n        this.config = config; // Update the layout\n\n        this._updateLayout();\n      }); // Subscribe to NavigationEnd event\n\n\n      this._router.events.pipe(filter(event => event instanceof NavigationEnd), takeUntil(this._unsubscribeAll)).subscribe(() => {\n        // Update the layout\n        this._updateLayout();\n      }); // Set the app version\n\n\n      this._renderer2.setAttribute(this._document.querySelector('[ng-version]'), 'fuse-version', FUSE_VERSION); // Set the OS name\n\n\n      this._renderer2.addClass(this._document.body, this._fusePlatformService.osName);\n    }\n    /**\n     * On destroy\n     */\n\n\n    ngOnDestroy() {\n      // Unsubscribe from all subscriptions\n      this._unsubscribeAll.next(null);\n\n      this._unsubscribeAll.complete();\n    } // -----------------------------------------------------------------------------------------------------\n    // @ Private methods\n    // -----------------------------------------------------------------------------------------------------\n\n    /**\n     * Update the selected layout\n     */\n\n\n    _updateLayout() {\n      // Get the current activated route\n      let route = this._activatedRoute;\n\n      while (route.firstChild) {\n        route = route.firstChild;\n      } // 1. Set the layout from the config\n\n\n      this.layout = this.config.layout; // 2. Get the query parameter from the current route and\n      // set the layout and save the layout to the config\n\n      const layoutFromQueryParam = route.snapshot.queryParamMap.get('layout');\n\n      if (layoutFromQueryParam) {\n        this.layout = layoutFromQueryParam;\n\n        if (this.config) {\n          this.config.layout = layoutFromQueryParam;\n        }\n      } // 3. Iterate through the paths and change the layout as we find\n      // a config for it.\n      //\n      // The reason we do this is that there might be empty grouping\n      // paths or componentless routes along the path. Because of that,\n      // we cannot just assume that the layout configuration will be\n      // in the last path's config or in the first path's config.\n      //\n      // So, we get all the paths that matched starting from root all\n      // the way to the current activated route, walk through them one\n      // by one and change the layout as we find the layout config. This\n      // way, layout configuration can live anywhere within the path and\n      // we won't miss it.\n      //\n      // Also, this will allow overriding the layout in any time so we\n      // can have different layouts for different routes.\n\n\n      const paths = route.pathFromRoot;\n      paths.forEach(path => {\n        // Check if there is a 'layout' data\n        if (path.routeConfig && path.routeConfig.data && path.routeConfig.data.layout) {\n          // Set the layout\n          this.layout = path.routeConfig.data.layout;\n        }\n      });\n    }\n    /**\n     * Update the selected scheme\n     *\n     * @private\n     */\n\n\n    _updateScheme() {\n      // Remove class names for all schemes\n      this._document.body.classList.remove('light', 'dark'); // Add class name for the currently selected scheme\n\n\n      this._document.body.classList.add(this.scheme);\n    }\n    /**\n     * Update the selected theme\n     *\n     * @private\n     */\n\n\n    _updateTheme() {\n      // Find the class name for the previously selected theme and remove it\n      this._document.body.classList.forEach(className => {\n        if (className.startsWith('theme-')) {\n          this._document.body.classList.remove(className, className.split('-')[1]);\n        }\n      }); // Add class name for the currently selected theme\n\n\n      this._document.body.classList.add(this.theme);\n    }\n\n  }\n\n  LayoutComponent.ɵfac = function LayoutComponent_Factory(t) {\n    return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(DOCUMENT), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FuseConfigService), i0.ɵɵdirectiveInject(i3.FuseMediaWatcherService), i0.ɵɵdirectiveInject(i4.FusePlatformService));\n  };\n\n  LayoutComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LayoutComponent,\n    selectors: [[\"layout\"]],\n    decls: 5,\n    vars: 5,\n    consts: [[4, \"ngIf\"]],\n    template: function LayoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, LayoutComponent_empty_layout_0_Template, 1, 0, \"empty-layout\", 0);\n        i0.ɵɵtemplate(1, LayoutComponent_centered_layout_1_Template, 1, 0, \"centered-layout\", 0);\n        i0.ɵɵtemplate(2, LayoutComponent_enterprise_layout_2_Template, 1, 0, \"enterprise-layout\", 0);\n        i0.ɵɵtemplate(3, LayoutComponent_material_layout_3_Template, 1, 0, \"material-layout\", 0);\n        i0.ɵɵtemplate(4, LayoutComponent_modern_layout_4_Template, 1, 0, \"modern-layout\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.layout === \"empty\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.layout === \"centered\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.layout === \"enterprise\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.layout === \"material\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.layout === \"modern\");\n      }\n    },\n    dependencies: [i5.NgIf, i6.EmptyLayoutComponent, i7.CenteredLayoutComponent, i8.EnterpriseLayoutComponent, i9.MaterialLayoutComponent, i10.ModernLayoutComponent],\n    styles: [\"layout{display:flex;flex:1 1 auto;width:100%;max-width:100%;min-width:0}layout>*{position:relative;display:flex;flex:1 1 auto;width:100%}layout router-outlet+*{position:relative;display:flex;flex:1 1 auto;width:100%}\\n\"],\n    encapsulation: 2\n  });\n  return LayoutComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}